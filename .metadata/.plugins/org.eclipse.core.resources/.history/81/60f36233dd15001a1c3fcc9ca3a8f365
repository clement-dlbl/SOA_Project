package fr.project_soa.master.ressources;

import java.io.IOException;
import java.util.ArrayList;
import java.util.List;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.client.RestTemplate;

import fr.project_soa.master.Config;
import fr.project_soa.master.model.Inside_Temp;
import fr.project_soa.master.use_case_1.UC1_main;

@RestController
public class UC2 {
	
	@GetMapping("/Use_Case_2")
	public List<String> getAlarm() {
		//Simulate data base
		//UC2_main uc2_main = new UC2_main();
		
		//Instanciate RestTemplate for Rest calls
		RestTemplate restTemplate = new RestTemplate();
		
		Inside_Temp res_in_temp = restTemplate.getForObject(Config.getTemperature_Service() + "/rooms/GEI213/sensors/temperature", Inside_Temp.class);
		//////
		//Outside_Temp res_out_temp = RECUPERER DE LA METEO
		//////
		List<String> res = new ArrayList<String>();
		res.add("Presence status : " + res_presence.isPresence());
		res.add("Alarm status : " + res_alarm.getStatus());
		System.out.println("before Triggering Alarm");
		try {
			res.add("Is alarm launched ?" + uc1_main.triggerAlarm(res_presence.isPresence(), res_alarm.getStatus()));
		} catch (IOException e) {
			e.printStackTrace();
		}
		
		return res;
	}
	
}
